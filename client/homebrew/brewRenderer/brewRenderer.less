@import (multiple, less) 'shared/naturalcrit/styles/reset.less';
@import (multiple, less) 'shared/naturalcrit/styles/scrollbars.less';

#preview-pane {
	display: grid;
	grid-template-columns: auto min-content;
	grid-template-rows: min-content auto;
	grid-template-areas: "toolbar toolbar"
		"preview panel";
	height: 100%;

	.toolBar {
		grid-area: toolbar;
		min-height: 30px;
		height: auto;
	}

	.headerNav {
		grid-area: panel;
		width: 250px;
	}

	iframe {
		grid-area: preview;
		border: 0;
		min-height: 0;
		height: 100%;
	}
	&:has(#preview-toolbar-dot) {
		grid-template-rows: 0 auto;
		// .toolBar.hidden {
		// 	display: none;
		// }
	}
	&:has(.headerNav.hidden) {
		grid-template-columns: auto 0;
		// .headerNav.hidden {
		// 	display: none;
		// }
	}

	// &:has(.toolBar.hidden) {
	// 	grid-template-areas: "preview panel"
	// 		"preview panel";
	// 	.toolBar.hidden {
	// 		display: none;
	// 	}
	// }
	// &:has(.headerNav.hidden) {
	// 	grid-template-areas: "toolbar toolbar"
	// 		"preview preview";
	// 	.headerNav.hidden {
	// 		display: none;
	// 	}
	// }
}

.brewRenderer {
	height        : 100vh;
	padding-top   : 30px;
	overflow-y    : scroll;
	will-change   : transform;
	&:has(.facing, .flow) { padding : 60px 30px; }
	&.deployment { background-color : darkred; }
	&.html-errors {
		#splash-image {
			height: 100%;
			display: grid;
			place-items: center;
			#broken-brew {
				text-align: center;
				color: #93a4b2;
				font-weight: bold;
				user-select: none;
				line-height: 1.3em;
				h2 {
					font-size: 28px;
					margin-bottom: 1em;
				}
				#icon-attribution {
					font-size: 13px;
					margin-top: 3em;
				}
				a:any-link {
					color: inherit;
				}
				svg {
					width: ~"min(70vw,400px)";
				}
			}
		}
	}
	:where(.pages) {
		&.facing {
			display               : grid; 
			grid-template-rows    : repeat(3, auto); 
			grid-template-columns : repeat(2, auto); 
			gap                   : 10px 10px; 
			justify-content       : safe center;
			&.recto .page:first-child {
				// sets first page on 'right' ('recto') of the preview, as if for a Cover page.  
				// todo: add a checkbox to toggle this setting
				grid-column-start : 2; 
			}
			& :where(.page) {
				margin-right : unset !important;
				margin-left  : unset !important;
			}
		}

		&.flow {
			display         : flex;
			flex-wrap       : wrap;
			gap             : 10px;
			justify-content : safe center;
			& :where(.page) {
				flex         : 0 0 auto;
				margin-right : unset !important;
				margin-left  : unset !important;
			}

		}

		& > :where(.page) {
			width         : 215.9mm;
			height        : 279.4mm;
			margin-right  : auto;
			margin-bottom : 30px;
			margin-left   : auto;
			box-shadow    : 1px 4px 14px #000000;
		}
		*[id] { scroll-margin-top : 100px; }
	}

	.scrollbar-styles(#fff0, #8fa1ad, 14px);
}

.pane { position : relative; }


@media print {
	.toolBar { display : none; }
	.brewRenderer {
		height     : 100%;
		padding    : unset;
		overflow-y : unset;
		&:has(.facing, .flow) {
			padding : unset;
		}
		.pages {
			margin  : 0px;
			zoom    : 100% !important;
			display : block;
			& > .page { box-shadow : unset; }
		}
	}
	.headerNav { visibility : hidden; }
}